%$Id: config_nux.tex 145 2005-03-25 08:26:35Z myk $

\clearpage
\pagebreak

\def\distrib#1{{\bf #1}}
\def\file#1{{\it #1}}
\def\app#1{{\sl #1}}
\def\menu#1{{\sl #1}}
\def\fkz{\server{frankiz}}

% \bghdr{fond-nux}

\subsection{Configuration sous Linux}

\subsubsection{Configuration IP}
Quelle que soit ta distribution, il faut que tu d\'ecides d'un nom de machine --- ton pseudo en g\'en\'eral.
Tu as \'egalement besoin de connaître les informations suivantes :
\begin{description}
  \item [ton adresse IP] not\'ee dor\'enavant \server{129.104.AAA.BBB}
  \item [l'IP de ta passerelle (\emph{gateway})] not\'ee \server{129.104.GGG.CCC}
        (attention, pour Foch, Fayolle et Maunoury ce n'est pas n\'ecessairement vrai que $GGG = AAA$).
  \item [ton masque de sous-r\'eseau] \server{255.255.FFF.DDD}
  \item [ton broadcast] qui est de la forme \server{129.104.GGG.EEE} avec $EEE = 255 - DDD$.
\end{description}

Toutes les informations n\'ecessaires se trouvent page \pageref{calcul_ip}.

Bien s\^ur, l'ensemble des manipulations doit se faire en tant que root.

\paragraph{\distrib{Sous Mandriva}}
{\bf Configuration du r\'eseau}
Il existe dans cette distribution une interface graphique pour configurer le r\'eseau, bien qu'il soit possible,
comme sur tout syst\`eme linux, de le faire \`a la main \`a partir des fichiers de configuration dans \file{/etc/}.

Lance \app{DrakConf} en tant que root, puis clique sur l'onglet \menu{R\'eseau & Internet} et enfin sur \menu{Configurer une nouvelle connexion Internet (LAN, ISDN, ADSL, ...)}. 
Choisis ensuite \menu{Connexion à travers un r\'eseau local(LAN)},puis la carte r\'eseau sur laquelle tu as branch\'e ton c\^able r\'eseau.
Tu as autant de \texttt{eth0}, \texttt{eth1}, \ldots que de cartes r\'eseau d\'etect\'ees.

Sur la fen\^etre suivante, choisis l'option \menu{configuration manuelle}.  La configuration du r\'eseau commence alors. 
Dans la première fen\^etre, entre :
\begin{description}
       \item[ton adresse IP] entre celle que tu as calcul\'ee : \server{129.104.AAA.BBB} (cf. page \pageref{calcul_ip})
       \item[ton masque de sous-r\'eseau] : \server{255.255.FFF.DDD} (cf. page \pageref{calcul_ip})
\end{description}

Ensuite, tu dois encore entrer :
\begin{description}
       \item[Nom d'hôte (non obligatoire)] : ton_pseudo
       \item[Serveur DNS 1] : \server{129.104.201.53}
       \item[Serveur DNS 2] : \server{129.104.201.54}
       \item[Serveur DNS 3] : \server{129.104.201.51}
       \item[Domaine recherch\'e] : eleves.polytechnique.fr polytechnique.fr
       \item[Passerelle] : tu l'as aussi calcul\'ee : \server{129.104.GGG.CCC} (cf. page \pageref{calcul_ip})
       \item[P\'eriph\'erique passerelle] : aucun
\end{description}

Clique ensuite deux fois sur suivant. (Tu n'as pas besoin d'entrer de nom d'h\^ote ZeroConf.)
Là, tu choisis l'option oui, puis tu valides et tu as normalement un message qui t'annonce que ta configuration r\'eseau est termin\'ee.

N'oublie pas d'ouvrir les ports qui vont bien (21 pour un serveur ftp,
5050 pourqRezix, ...) dans ton firewall pour pouvoir pleinement profiter du r\'eseau

{\bf Configuration du gestionnaire de paquets :}
Le BR poss\`ede ses propres miroirs mandriva, que nous te conseillons d'utiliser, ceux-ci \'etant beaucoup plus rapide que les miroirs ext\'erieurs.
Dans l'utilitaire \app{Drakconf], choisis l'onglet \menu{Gestionnaire de logiciels}, puis clique sur \menu{ajouter la source personalis\'ee}, \`a choisir serveur ftp et à mettre comme url \url{ftp://miroir/mandriva}.



Voil\`a, c'est bon ! Tu peux passer au paragraphe 2 !

\paragraph{\distrib{Sous Gentoo}}

Si tu n'as jamais fait de configuration r\'eseau sur ta Gentoo, il faudra certainement cr\'eer les fichiers qui suivent.

Le fichier \file{/etc/hostname} contient ton nom de machine.
Tu peux \'editer \file{/etc/hostname} avec ton \'editeur pr\'ef\'er\'e
(\app{vi} ou \app{vim}, \app{pico}, voire \app{emacs} si tu aimes),
mais la commande ci-dessous est suffisante :

\cmdline{echo 'ton\_pseudo' > /etc/hostname}

Le fichier \file{/etc/resolv.conf} d\'ecrit comment r\'esoudre les noms DNS.
La premi\`ere ligne donne le domaine sur lequel ta machine est, 
ensuite viennent les suffixes \`a utiliser par d\'efaut,
et les lignes suivantes indiquent les serveurs de noms,
ceux qui associent le nom \server{frankiz} ou \server{ton\_pseudo}
aux IP \server{129.104.201.51} ou \server{'ton\_ip'}.
Le fichier contient donc :

\noindent \cmdline{
domain eleves.polytechnique.fr\\
search eleves.polytechnique.fr polytechnique.fr\\
nameserver 129.104.201.53\\
namaserver 129.104.201.52}

Enfin, le fichier \file{/etc/conf.d/net} contient la description de l'interface r\'eseau et les informations de routage.
Il indique ton IP, ton sous-r\'eseau, ton masque de sous-r\'eseau et la passerelle pour sortir de ton sous-r\'eseau :

\noindent \cmdline{iface\_eth0="129.104.AAA.BBB broadcast 129.104.HHH.EEE $\backslash$\\
                            netmask 255.255.FFF.DDD"\\
                            gateway="eth0/129.104.GGG.CCC"}

Tu fais le grand test en rechargeant ta configuration r\'eseau par :

\cmdline{/etc/init.d/net.eth0 restart}

puis en pingant \fkz\ par exemple. Tu dois obtenir quelque chose comme :

\cmdline{root:~\# ping frankiz\\
PING frankiz (129.104.201.51) 56(84) bytes of data.\\
64 bytes from frankiz (129.104.201.51): ...}

Pour pouvoir utiliser \app{emerge} \`a travers le proxy de l'\'ecole,
il faut d\'efinir les variables d'environnement ci-dessous dans le fichier \file{/etc/make.conf} :

\cmdline{http\_proxy=http://kuzh.polytechnique.fr:8080\\
GENTOO\_MIRRORS="ftp://miroir/gentoo http://gentoo.osuosl.org/"\\
SYNC="rsync://rsync/gentoo-portage"}

Tu peux \'evidemment ajouter d'autres miroirs (s\'epar\'es par des espaces) dans ta liste
mais \url{ftp://miroir} \'etant interne, il sera toujours beaucoup plus rapide que les autres.
On te conseille ici \url{http://gentoo.osuosl.org/} qui est un miroir tr\`es complet mais tr\`es lent.

\input ubuntu.tex

\subsubsection{Configuration antivirus \footnotesize{(elle est dr\^ole celle-l\`a hein ?)}
}

\subsubsection{Configuration firewall}

La solution la plus simple pour se faire un firewall sous linux est d'utiliser les iptables.
Pour ceci la premi\`ere \'etape est d'installer le paquet \app{iptables} pour ta distribution.
Pour savoir comment configurer ton firewall pour le r\'eseau de l'X, consulte la FAQ de Frankiz.

\subsubsection{Configuration navigateur web}

%\image{partie1-config_reseau/nux_proxy_firefox}{0.66}{Configuration du proxy sous Firefox}

%\flimage{partie1-config_reseau/nux_firefox_icon}{0.12}{l}
Le BR te conseille d'utiliser \app{Firefox}, ou \app{Konqueror} (le navigateur fourni par d\'efaut avec KDE). Dans tous les cas, la seule configuration \`a mettre est celle du proxy.
Il suffit d'aller dans \menu{Edit}, \menu{Preferences} et dans l'onglet \menu{General}
cliquer sur \menu{Connection Settings} ; ensuite tu coches la case \menu{D\'etection automatique du proxy pour ce r\'eseau},
et c'est bon.

\subsubsection{Configuration mail}

%\flimage{partie1-config_reseau/nux_kmail_icon}{0.12}{l}
Le client mail le plus utilis\'e est \app{Kmail}, mais il en existe bien s\^ur d'autres comme \app{Thunderbird}.

Va dans \menu{Configuration}, \menu{Configurer Kmail}.
Choisis la rubrique \menu{R\'eseau}.
Commence par cr\'eer un nouveau compte dans l'onglet \menu{R\'eception des messages}
en cliquant sur le bouton \menu{Ajouter\ldots} et choisis le type POP3.

%\image{partie1-config_reseau/nux_config_kmail_pop}{0.66}{Configuration de la r\'eception des messages sous Kmail}

Utilise les param\`etres suivants pour configurer l'onglet \menu{G\'en\'eral} :
\begin{description}
  \item[Nom] le nom du compte, par exemple : Mails Poly
  \item[Utilisateur] rentre le login \server{poly} que t'a fourni la DSI \`a ton arriv\'ee sur le plateau
  \item[Mot de passe] idem
  \item[Serveur] \server{poly.polytechnique.fr}
  \item[Port] 995
\end{description}

Ensuite, va dans l'onglet \menu{Extras} et coche la case \menu{Utiliser SSL pour s\'ecuriser les t\'el\'echargements}.

%\image{partie1-config_reseau/nux_config_kmail_smtp}{0.66}{Configuration de l'envoi des messages sous Kmail}

Maintenant, dans l'onglet \menu{Envoi des messages} clique sur le bouton \menu{Ajouter\ldots}.
Utilise les param\`etres suivants pour le configurer :
\begin{description}
  \item[Nom] le m\^eme nom de compte que pr\'ec\'edemment
  \item[Serveur] \server{poly.polytechnique.fr}
  \item[Port] 25
\end{description}
Sinon, laisse toutes les cases d\'ecoch\'ees.

\subsubsection{Configuration news}

%\flimage{partie1-config_reseau/nux_knode_icon}{0.12}{l}
Le client news le plus utilis\'e est \app{Knode}.
Parmi les autres clients news, citons \app{Thunderbird} ou \app{slrn}.

%\image{partie1-config_reseau/nux_config_knode}{0.7}{Configuration de Knode}

Sous \app{Knode}, c'est dans le menu \menu{Configuration}, puis \menu{Configurer Knode}.
Va dans la rubrique \menu{Comptes, Forums de discussion} et cr\'ee un compte en cliquant sur \menu{Nouveau\ldots}.

Remplis l'onglet \menu{Serveur} avec les informations suivantes :
\begin{description}
  \item[Nom] ce que tu veux pour d\'ecrire ce compte, par exemple 'News Frankiz'
  \item[Serveur] \server{frankiz.polytechnique.fr}
  \item[Port] 119
\end{description}

Ensuite occupe-toi de l'onglet \menu{Identit\'e} :
\begin{description}
  \item[Nom] mets ton pseudo dans ce champ
  \item[Organisation] X, École Polytechnique, comme tu le sens
  \item[Adresse \'electronique] ton adresse mail, pour que les gens puissent te r\'epondre par mail.
\end{description}

Enfin, pour que \app{Knode} puisse envoyer des mails, il faut aller dans la rubrique \menu{Comptes},
sous-rubrique \menu{Courrier \'electronique}, et choisir comme serveur d'envoi de mails \server{poly.polytechnique.fr},
port 25 --- c'est exactement la m\^eme configuration SMTP que \app{Kmail}.

Si tu veux mettre une signature \`a la fin des messages que tu posteras,
il te suffit de la mettre dans l'onglet \menu{Identit\'e}.
Sur la plupart des clients la signature est interpr\'et\'ee comme ext\'erieure au message
et n'est en particulier pas incluse dans le texte cit\'e lorsque tu r\'eponds \`a un message.
Pour d\'efinir une signature \`a la main, il suffit de mettre \verb*+-- +\ (c'est \`a dire -{}-<espace>)
sur une ligne, et tout ce qui suivra cette ligne composera ta signature.

Il ne te reste plus qu'\`a t'inscrire \`a des newsgroups
(reporte-toi \`a la page \pageref{newsgroups} pour plus d'infos) et \`a poster !

Pour te connecter aux serveurs de news de Polytechnique.org, qui ont un acc\`es s\'ecuris\'e,
avec \app{Knode}, il y a une petite subtilit\'e car il ne g\`ere pas le SSL.
Il faut installer \app{stunnel} qui permet de d\'efinir une redirection SSL de port.
Dans \file{/etc/stunnel.conf} ou \file{/etc/stunnel/stunnel.conf} selon ta distribution,
mets les lignes suivantes (les trois premi\`eres y sont en principe d\'ej\`a) :

\cmdline{\# location of pid file\\
pid = /etc/stunnel/stunnel.pid\\
\\
\# user to run as\\
setuid = stunnel\\
setgid = stunnel\\
\\
\# Use it for client mode\\
client = yes\\
\\
\# sample service-level configuration\\
\\
{[}nntps{]}\\
accept  = 1119\\
connect = ssl.polytechnique.org:563\\
TIMEOUTclose = 0\\
}

Il ne te reste plus qu'\`a lancer \app{stunnel} par :

\cmdline{/etc/init.d/stunnel start}

Et tu peux ainsi lire les news de Polytechnique.org en mettant \server{localhost} comme serveur
et \server{1119} comme port.
Il faut aussi que tu coches \menu{Le serveur exige une identification}
et que tu rentres ton nom d'utilisateur \`a Polytechnique.org et ton mot de passe,
que tu peux d\'efinir sur \url{http://www.polytechnique.org/acces\_smtp.php}.

\vfill

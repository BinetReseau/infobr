%$Id: config_nux.tex 145 2005-03-25 08:26:35Z myk $

\clearpage
\pagebreak

\bghdr{images/fond-nux}

%\begin{center}
%\includegraphics{images/logo_Linux}
%\end{center}

\subsection{Configuration sous Linux}

\subsubsection{Configuration IP}
Quelle que soit ta distribution, il faut que tu décides d'un nom de
machine --- ton pseudo en général. Tu as également besoin de
connaître les informations suivantes :
\begin{description}
  \item [ton adresse IP] notée dorénavant \server{129.104.AAA.BBB} ;
  \item [l'IP de ta passerelle (\emph{gateway})] notée \server{129.104.GGG.CCC} ;
  \item [ton masque de sous-réseau] \server{255.255.FFF.DDD} ;
  \item [ton broadcast] qui est de la forme \server{129.104.GGG.EEE} avec $EEE = 255 - DDD$. \\
        \textcolor{red}{(attention, $GGG = AAA$ n'est valable que dans les nouveaux caserts, le PEM et le BEM. Pour Foch, Fayolle et Maunoury ce n'est donc pas nécessairement vrai que $GGG =
        AAA$.)}.
\end{description}

Toutes les informations nécessaires se trouvent page
\pageref{calcul_ip}.

Bien sûr, l'ensemble des manipulations doit se faire en tant que \emph{root}.


\paragraph{\distrib{Sous Gentoo}}

Si tu n'as jamais fait de configuration réseau sur ta Gentoo, il
faudra certainement créer les fichiers qui suivent.

Le fichier \file{/etc/hostname} contient ton nom de machine. Tu peux
éditer \file{/etc/hostname} avec ton éditeur préféré (\app{vi} ou
\app{vim}, \app{pico}, voire \app{emacs} si tu aimes), mais la
commande ci-dessous est suffisante :

\cmdline{echo 'ton\_pseudo' > /etc/hostname}

Le fichier \file{/etc/resolv.conf} décrit comment résoudre les noms DNS. La première ligne donne le domaine sur lequel ta machine est, ensuite
viennent les suffixes à utiliser par défaut ; les lignes suivantes indiquent les serveurs de noms, ceux qui associent le nom \server{frankiz} ou
\server{ton\_pseudo} aux IP \server{129.104.201.51} ou \server{'ton\_ip'}. Le fichier contient donc :

\noindent \cmdline{
domain eleves.polytechnique.fr\\
search eleves.polytechnique.fr polytechnique.fr\\
nameserver 129.104.201.53\\
namaserver 129.104.201.52}

Enfin, le fichier \file{/etc/conf.d/net} contient la description de l'interface réseau et les informations de routage. Il indique ton IP, ton
sous-réseau, ton masque de sous-réseau et la passerelle pour sortir de ton sous-réseau . Bien sûr, remplace \texttt{eth0} par le nom de l'interface
réseau que tu utilises, si ce n'est pas la carte \emph{ethernet} par défaut.

\noindent \cmdline{iface\_eth0="129.104.AAA.BBB broadcast 129.104.GGG.EEE $\backslash$\\
                            netmask 255.255.FFF.DDD"\\
                            gateway="eth0/129.104.GGG.CCC"}

Tu fais le grand test en rechargeant ta configuration réseau par :

\cmdline{/etc/init.d/net.eth0 restart}

puis en \emph{pingant} \fkz\ par exemple. Tu dois obtenir quelque chose comme :

\cmdline{root:~\# ping frankiz\\
PING frankiz (129.104.201.51) 56(84) bytes of data.\\
64 bytes from frankiz (129.104.201.51): ...}

\label{gentoo_mirror} Pour pouvoir utiliser \app{emerge} à travers le \emph{proxy} de l'école, il faut définir les variables d'environnement
ci-dessous dans le fichier \file{/etc/make.conf} :

\cmdline{http\_proxy=http://kuzh.polytechnique.fr:8080\\
ftp\_proxy=http://kuzh.polytechnique.fr:8080\\
no\_proxy=.eleves.polytechnique.fr\\
GENTOO\_MIRRORS="ftp://miroir.eleves.polytechnique.fr/gentoo http://gentoo.osuosl.org/"\\
SYNC="rsync://rsync/gentoo-portage"}

Tu peux évidemment ajouter d'autres miroirs (séparés par des
espaces) dans ta liste mais \url{ftp://miroir} étant interne, il
sera toujours beaucoup plus rapide que les autres. On te conseille
ici \url{http://gentoo.osuosl.org/} qui est un miroir très complet
mais très lent.

\input{ubuntu.tex}

\subsubsection{Configuration antivirus \footnotesize{(elle est drôle celle-là hein ?)}
}

\subsubsection{Configuration du pare-feu}

La solution la plus simple pour se faire un \emph{firewall} sous linux est d'utiliser les \emph{iptables}. Pour ceci la première étape est
d'installer le paquet \app{iptables} pour ta distribution. Pour savoir comment configurer ton \emph{firewall} pour le réseau de l'X, consulte la FAQ
de Frankiz.

\subsubsection{Configuration navigateur web}

\flimage{images/nux_firefox_icon}{0.12}{l} Le BR te conseille d'utiliser \app{Firefox} ou \app{Konqueror} (le navigateur fourni par défaut avec KDE).
Dans tous les cas, la seule configuration à effectuer est celle du \emph{proxy}. Pour \app{Firefox}, il suffit d'aller dans \menu{Edit},
\menu{Preferences} et dans l'onglet \menu{Avancé}, puis de cliquer sur l'onglet \menu{Réseau}, et enfin \menu{Paramètres de connexion} ; ensuite
coche la case \menu{Adresse de configuration automatique du proxy}, et rentre \url{http://frankiz/proxy.pac/}.

Sous \app{Konqueror}, cela se trouve dans le menu \menu{Configuration}, \menu{Configurer Konqueror},
dans l'onglet \menu{Serveur mandataire}.

\imagepos{images/nux_proxy_firefox}{0.55}{Configuration du proxy sous Firefox}{ht}

% \vfill
\pagebreak

\subsubsection{Configuration mail}

\flimage{images/nux_kmail_icon}{0.12}{l} Le client mail le plus
utilisé est \app{Kmail}, mais il en existe bien s\^ur d'autres comme
\app{Thunderbird}. La configuration est semblable, quel que soit le
client que tu utilises.

Va dans \menu{Configuration}, \menu{Configurer Kmail}. Choisis la
rubrique \menu{Comptes}. Commence par créer un nouveau compte dans
l'onglet \menu{Réception des messages} en cliquant sur le bouton
\menu{Ajouter\ldots} et choisis le type POP3.

\imagepos{images/nux_config_kmail_pop}{0.45}{Configuration de la réception des messages sous Kmail}{pht}

Utilise les paramètres suivants pour configurer l'onglet
\menu{Général} :
\begin{description}
  \item[Nom] le nom du compte, par exemple : Mails Poly
  \item[Utilisateur] rentre le login \server{poly} que t'a fourni la DSI à ton arrivée sur le plateau
  \item[Mot de passe] et là le mot de passe \server{poly}
  \item[Serveur] \server{poly.polytechnique.fr}
  \item[Port] 995
\end{description}

Ensuite, va dans l'onglet \menu{Extras} et coche la case
\menu{Utiliser SSL pour sécuriser les téléchargements}.

\imagepos{images/nux_config_kmail_smtp}{0.45}{Configuration de l'envoi des messages sous Kmail}{pht}

Maintenant, dans l'onglet \menu{Envoi des messages} clique sur le
bouton \menu{Ajouter\ldots}. Utilise les paramètres suivants pour le
configurer :
\begin{description}
  \item[Nom] le même nom de compte que précédemment
  \item[Serveur] \server{poly.polytechnique.fr}
  \item[Port] 25
\end{description}
Sinon, laisse toutes les cases décochées.

\par Tu peux aussi configurer l'accès à \app{l'annuaire LDAP} de l'école, sorte de carnet d'adresses en ligne qui contient les adresses mail de tout le monde sur le campus. Pour ce faire, commence par ouvrir \menu{Outils}, \menu{Carnet d'adresses}, puis va dans \menu{Configuration}, \menu{Configurer kAdressBook}, \menu{Consultation LDAP}. Clique ensuite sur \menu{Ajouter un hôte}, et configure comme suit:
\begin{description}
  \item[Hôte] \server{ldap.eleves.polytechnique.fr}
  \item[Port] 389
  \item[Version de LDAP] 3
  \item[DN] dc=ldap,dc=eleves,dc=polytechnique,dc=fr
  \item[Sécurité] Non
  \item[Identification] Anonyme
\end{description}
Une fois revenu dans \menu{Configuration LDAP}, coche la case \server{ldap.eleves.polytechnique.fr}. Tu as maintenant accès au LDAP lors de la
rédaction de messages, avec tout au plus un redémarrage de \app{Kmail}. \imagepos{images/nux_config_ldap}{0.55}{Configuration de l'annuaire LDAP sous
Kmail}{pht}

\subsubsection{Configuration news}
\flimage{images/nux_knode_icon}{0.12}{l} Le client news le plus
utilisé est \app{Knode}. Parmi les autres clients news, citons
\app{Thunderbird} ou \app{slrn}. Ici aussi, la configuration est
presque indépendante du logiciel choisi.

Sous \app{Knode}, c'est dans le menu \menu{Configuration}, puis \menu{Configurer Knode}. Va dans la rubrique \menu{Comptes, Forums de discussion} et
crée un compte en cliquant sur \menu{Ajouter\ldots}.

\imagepos{images/nux_config_knode}{0.45}{Configuration de Knode}{ht}

Remplis l'onglet \menu{Serveur} avec les informations suivantes :
\begin{description}
  \item[Nom] ce que tu veux pour décrire ce compte, par exemple 'News Frankiz'
  \item[Serveur] \server{frankiz.polytechnique.fr}
  \item[Port] 119
\end{description}
Ensuite occupe-toi de l'onglet \menu{Identité} :
\begin{description}
  \item[Nom] mets ton pseudo dans ce champ
  \item[Organisation] X, École Polytechnique, comme tu le sens
  \item[Adresse électronique] ton adresse mail, pour que les gens puissent te répondre par mail.
\end{description}

Enfin, pour que \app{Knode} puisse envoyer des mails, il faut aller
dans la rubrique \menu{Comptes}, sous-rubrique \menu{Serveur de
courrier (SMTP)}, et choisir comme serveur d'envoi de mails
\server{poly.polytechnique.fr}, port 25 --- c'est exactement la même
configuration SMTP que \app{Kmail}.

Si tu veux mettre une signature à la fin des messages que tu
posteras, il te suffit de la mettre dans l'onglet \menu{Identité}.
Sur la plupart des clients la signature est interprétée comme
extérieure au message et n'est en particulier pas incluse dans le
texte cité lorsque tu réponds à un message. Pour définir une
signature à la main, il suffit de mettre \verb*+-- +\ (c'est à dire
-{}-<espace>) sur une ligne, et tout ce qui suivra cette ligne
composera ta signature.

Il ne te reste plus qu'à t'inscrire à des \emph{newsgroups} (reporte-toi à la page \pageref{newsgroups} pour plus d'infos) et à poster !

Pour te connecter aux serveurs de \emph{news} de Polytechnique.org, qui ont un accès sécurisé, avec \app{Knode}, il y a une petite subtilité car il
ne gère pas le SSL. Il faut installer \app{stunnel} qui permet de définir une redirection SSL de port. Dans \file{/etc/stunnel.conf} ou
\file{/etc/stunnel/stunnel.conf} selon ta distribution, mets les lignes suivantes (les trois premières y sont en principe déjà) :

\cmdline{\# location of pid file\\
pid = /etc/stunnel/stunnel.pid\\
\\
\# user to run as\\
setuid = stunnel\\
setgid = stunnel\\
\\
\# Use it for client mode\\
client = yes\\
\\
\# sample service-level configuration\\
\\
{[}nntps{]}\\
accept  = 1119\\
connect = ssl.polytechnique.org:563\\
TIMEOUTclose = 0
}

Il ne te reste plus qu'à lancer \app{stunnel} par :

\cmdline{/etc/init.d/stunnel start}

Et tu peux ainsi lire les news de Polytechnique.org en mettant
\server{localhost} comme serveur et \server{1119} comme port. Il
faut aussi que tu coches \menu{Le serveur exige une identification}
et que tu rentres ton nom d'utilisateur à Polytechnique.org et ton
mot de passe, que tu peux définir sur
\url{http://www.polytechnique.org/acces\_smtp.php}.
